"use strict";angular.module("aquiferiumApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngAnimate","angular-carousel","angular-parallax","videosharing-embed","d3-map","d3-visualizations"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/explore.html",controller:"ExploreCtrl"}).when("/explore",{templateUrl:"views/explore.html",controller:"ExploreCtrl"}).when("/caves-karsts",{templateUrl:"views/caves-karsts.html",controller:"CavesKarstsCtrl"}).when("/conservation",{templateUrl:"views/conservation.html",controller:"ConservationCtrl"}).when("/springs",{templateUrl:"views/springs.html",controller:"SpringsCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/contact",{templateUrl:"views/contact.html",controller:"ContactCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("aquiferiumApp").controller("NavigationCtrl",["$scope","$location",function(a,b){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.isCollapsed=!0,a.$on("$routeChangeSuccess",function(){a.isCollapsed=!0}),a.logLocation=function(){console.log(b.$$path)},a.getClass=function(a){return"/"===a&&"/"===b.path()?"active":b.path().substr(0,a.length)===a?"active":void 0}}]),angular.module("aquiferiumApp").controller("ExploreCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.pageClass="explore",a.randomColor=function(){var a="#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6);return a},a.lastClickTarget={},a.newSelection={},a.oldSelection={},a.moveToFront=function(a){return console.log("moveToFront: ",a),a.each(function(){a.parentNode.appendChild(a)})},a.moveToBack=function(a){return console.log("moveToBack: ",a),a.each(function(){var b=a.parentNode.firstChild;b&&a.parentNode.insertBefore(a,b)})},a.onTargetClick=function(a){return console.log(a),newSelection=d3.select(this),console.log(newSelection),"hidden"===tooltip.style("visibility")?(moveToFront(newSelection),newSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadiusSelected).style("stroke-width","3px").style("stroke","#ff0"),lastClickTarget=a,oldSelection=newSelection,tooltip.style("visibility","visible").html("<h2>"+a.Location+'</h2><br/><img src="'+a.img+'" alt="" /><br/><a href="../">Explore</a>')):"visible"===tooltip.style("visibility")&&a!==lastClickTarget?(moveToBack(oldSelection),oldSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadius).style("stroke-width","1px").style("stroke","#000"),moveToFront(newSelection),newSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadiusSelected).style("stroke-width","3px").style("stroke","#ff0"),lastClickTarget=a,oldSelection=newSelection,tooltip.style("visibility","visible").html("<h2>"+a.Location+'</h2><br/><img src="'+a.img+'" alt="" /><br/><a href="../">Explore</a>')):(newSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadius).style("stroke-width","1px").style("stroke","#000"),lastClickTarget={},oldSelection={},newSelection={},tooltip.style("visibility","hidden"))}}]),angular.module("aquiferiumApp").controller("CavesKarstsCtrl",["$scope","$location","$anchorScroll",function(a,b,c){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.pageClass="caves-karsts",a.resetView=function(){b.hash(".caveskarsts"),c()},a.resetView(),a.goToByScroll=function(a){var b=$("#navbar").innerHeight(),c=angular.element(document).find("body").css("class",".caveskarsts");c.animate({scrollTop:$('.slide[data-slide="'+a+'"]').offset().top-b},2e3,"easeInOutQuint")},a.buttonClick=function(b){b.preventDefault();var c=angular.element(b.target).attr("data-slide");a.goToByScroll(c)}}]),angular.module("aquiferiumApp").controller("ConservationCtrl",["$scope","$location","$anchorScroll",function(a,b,c){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.pageClass="conservation",a.resetView=function(){b.hash(".conservation"),c()},a.resetView(),a.goToByScroll=function(a){var b=$("#navbar").innerHeight(),c=angular.element(document).find("body").css("class",".conservation");c.animate({scrollTop:$('.slide[data-slide="'+a+'"]').offset().top-b},2e3,"easeInOutQuint")},a.buttonClick=function(b){b.preventDefault();var c=angular.element(b.target).attr("data-slide");a.goToByScroll(c)},a.randomColor=function(){var a="#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6);return a},a.lastClickTarget={},a.newSelection={},a.oldSelection={},a.moveToFront=function(a){return console.log("moveToFront: ",a),a.each(function(){a.parentNode.appendChild(a)})},a.moveToBack=function(a){return console.log("moveToBack: ",a),a.each(function(){var b=a.parentNode.firstChild;b&&a.parentNode.insertBefore(a,b)})},a.onTargetClick=function(a){return console.log(a),newSelection=d3.select(this),console.log(newSelection),"hidden"===tooltip.style("visibility")?(moveToFront(newSelection),newSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadiusSelected).style("stroke-width","3px").style("stroke","#ff0"),lastClickTarget=a,oldSelection=newSelection,tooltip.style("visibility","visible").html("<h2>"+a.Location+'</h2><br/><img src="'+a.img+'" alt="" /><br/><a href="../">Explore</a>')):"visible"===tooltip.style("visibility")&&a!==lastClickTarget?(moveToBack(oldSelection),oldSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadius).style("stroke-width","1px").style("stroke","#000"),moveToFront(newSelection),newSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadiusSelected).style("stroke-width","3px").style("stroke","#ff0"),lastClickTarget=a,oldSelection=newSelection,tooltip.style("visibility","visible").html("<h2>"+a.Location+'</h2><br/><img src="'+a.img+'" alt="" /><br/><a href="../">Explore</a>')):(newSelection.transition().duration(markerStrokeAnimationSpeed).attr("r",markerRadius).style("stroke-width","1px").style("stroke","#000"),lastClickTarget={},oldSelection={},newSelection={},tooltip.style("visibility","hidden"))}}]),angular.module("aquiferiumApp").controller("SpringsCtrl",["$window","$scope","$location","$anchorScroll",function(a,b,c,d){b.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],b.pageClass="springs",b.hcpurl="http://eahcp.org/index.php/about_eahcp/covered_species",b.trustUrl=function(a){return $sce.trustAsResourceUrl(a)},b.resetView=function(){c.hash(".springs"),d()},b.resetView(),b.goToByScroll=function(a){var b=$("#navbar").innerHeight(),c=angular.element(document).find("body").css("class",".springs");c.animate({scrollTop:$('.slide[data-slide="'+a+'"]').offset().top-b},2e3,"easeInOutQuint")},b.buttonClick=function(a){console.log("firing click event from controller $scope with e == "+a.valueOf()),a.preventDefault();var c=angular.element(a.target).attr("data-slide");b.goToByScroll(c)},b.linkModelFunc=function(b){console.log("link model function"),a.open(b)}}]),angular.module("aquiferiumApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.pageClass="about",a.code="SUhtSnl_ZRM"}]),angular.module("aquiferiumApp").controller("ContactCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.pageClass="contact"}]),angular.module("d3-visualizations",[]).directive("texasEaaAquifers",function(){function a(a,b){function c(a){var b=d3.interpolate(this._current,a);return this._current=b(0),function(a){return l(b(a))}}var d=d3.scale.category10(),e=b[0],f=e.clientWidth,g=e.clientHeight,h=Math.min(f,g),i=(Math.min(f,g)/2,750),j="circle-in-out",k=d3.layout.pie().sort(null),l=d3.svg.arc().outerRadius(h/2*.9).innerRadius(h/2*.5);console.log(e);{var m=d3.select(e).append("svg:svg").attr({width:f,height:g}),n=m.append("g").attr("class","donut").attr("transform","translate("+f/2+","+g/2+")");n.selectAll(".donut").data(k(a.data)).enter().append("path").attr("class","arc").style("stroke","white").attr("fill",function(a,b){return d(b)}).each(function(a){return this._current=a})}m.on("mousedown",function(){a.$apply(function(){a.onClick&&a.onClick()})});{var o=m.append("svg:g").attr("class","ctrGroup").attr("transform","translate("+f/2+","+g/2+")");o.append("svg:text").attr("dy",".35em").attr("class","chartLabel").attr("text-anchor","middle").text("CLICK THE DONUT"),n.selectAll(".arc").data(k(a.data)).enter().append("svg:text").attr("class","arcLabel").attr("transform",function(a){return"translate("+l.centroid(a)+")"}).attr("text-anchor","middle").text(function(a){return a.data})}a.$watch("data",function(b,e){for(var f=50,g=b.slice(0),h=Math.PI;g.length<e.length;)g.push(0);var m=n.selectAll(".arc").data(k(g));m.transition().delay(function(a,b){return b*f}).duration(i).ease(j).attrTween("d",c),m.enter().append("path").style("stroke","white").attr("class","arc").attr("fill",function(a,b){return d(b)}).each(function(){this._current={startAngle:2*h-.001,endAngle:2*h}}).transition().delay(function(a,b){return b*f}).duration(i).attrTween("d",c),m.filter(function(a){return 0===a.data}).transition().delay(function(a,b){return b*f}).duration(i).each(function(a){a.startAngle=2*h-.001,a.endAngle=2*h}).attrTween("d",c).remove();var o=n.selectAll(".donut").data(k(a.data));o.enter().append("svg:text").attr("class","arcLabel").attr("text-anchor","middle").text(function(a){return a.data}).transition().delay(function(a,b){return b*f}).duration(i).ease("elastic").attr("transform",function(a){return"translate("+l.centroid(a)+")"}),o.exit().transition().duration(i).attr("opacity",0).remove()})}return console.log("texasEaaAquifers directive initialized."),{scope:{data:"=",onClick:"&"},restrict:"E",replace:!1,link:a}}),angular.module("d3-map",[]).directive("eaaAquifersMap",function(){function a(a,b){function c(){var a="#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6);return a}function d(a){console.log(a)}var e=window,f=document,g=f.documentElement,h=f.getElementsByTagName("body")[0],i=e.innerWidth||g.clientWidth||h.clientWidth,j=e.innerHeight||g.clientHeight||h.clientHeight,k=.965,l=.65,m=i*k,n=j*l,o="data/geojson/NEW_major_aquifers_dd_reduced100.geo.json",p="data/geojson/eaa_boundary_EPSG-3081.geo.json",q="data/eaaAquiferium-allSprings-markerData.csv",r={top:0,right:0,bottom:0,left:0},s=m-r.left-r.right,t=n-r.top-r.bottom;console.log("width: ",m),console.log("height: ",n),console.log("vizMargin: ",r),console.log("vizWidth: ",s),console.log("vizHeight: ",t);var u=b[0],v=(d3.select(u).append("div").attr("class","tooltip"),d3.select(u).append("div").attr("class","map"),d3.select(".map").append("svg").attr("height",n).attr("class","mapSvg")),w=v.append("g").attr("class","texas"),x=v.append("g").attr("class","boundaries"),y=5;d3.json(o,function(a,b){if(a)return console.error(a);var e=4*n,f=[m/2,n/2],g=d3.geo.centroid(b),h=d3.geo.mercator().scale(e).center(g).translate(f),i=d3.geo.path().projection(h),j=w.selectAll("g").data(b.features).enter().append("g");j.append("path").attr("d",i).attr("class","area").attr("fill","#425968").attr("stroke","#4298B5"),d3.json(p,function(a,b){if(a)return console.error(a);var e=x.selectAll("g").data(b.features).enter().append("g");e.append("path").attr("d",i).attr("class","area").attr("fill","#8F8100").attr("stroke","#000"),d3.csv(q,function(a,b){return a?console.error(a):void e.selectAll("circle").data(b).enter().append("circle").attr("cx",function(a){return h([a.lon_ddd,a.lat_ddd])[0]}).attr("cy",function(a){return h([a.lon_ddd,a.lat_ddd])[1]}).attr("r",y).attr("z-index",0).style("fill",function(){return c()}).style("stroke","#000").on("click",d)})})})}return{restrict:"E",replace:!1,scope:{data:"=",onClick:"&"},link:a}}),angular.module("d3-visualizations",[]).directive("eaaAquifersBoundaryMap",function(){function a(a,b){function c(){var a="#"+("00000"+(Math.random()*(1<<24)|0).toString(16)).slice(-6);return a}function d(a){console.log(a)}var e=window,f=document,g=f.documentElement,h=f.getElementsByTagName("body")[0],i=e.innerWidth||g.clientWidth||h.clientWidth,j=e.innerHeight||g.clientHeight||h.clientHeight,k=.965,l=.65,m=i*k,n=j*l,o="data/geojson/eaa_boundary_EPSG-3081.geo.json",p="data/eaaAquiferium-allSprings-markerData.csv",q={top:0,right:0,bottom:0,left:0},r=m-q.left-q.right,s=n-q.top-q.bottom;console.log("width: ",m),console.log("height: ",n),console.log("vizMargin: ",q),console.log("vizWidth: ",r),console.log("vizHeight: ",s);var t=b[0],u=(d3.select(t).append("div").attr("class","tooltip"),d3.select(t).append("div").attr("class","map"),d3.select(".map").append("svg").attr("height",n).attr("class","mapSvg")),v=u.append("g").attr("class","boundaries"),w=10;d3.json(o,function(a,b){if(a)return console.error(a);var e=24*n,f=[m/2,n/2],g=d3.geo.centroid(b),h=d3.geo.mercator().scale(e).center(g).translate(f),i=d3.geo.path().projection(h),j=v.selectAll("g").data(b.features).enter().append("g");j.append("path").attr("d",i).attr("class","area").attr("fill","#8F8100").attr("stroke","#000"),d3.csv(p,function(a,b){return a?console.error(a):void j.selectAll("circle").data(b).enter().append("circle").attr("cx",function(a){return h([a.lon_ddd,a.lat_ddd])[0]}).attr("cy",function(a){return h([a.lon_ddd,a.lat_ddd])[1]}).attr("r",w).attr("z-index",0).style("fill",function(){return c()}).style("stroke","#000").on("click",d)})})}return{restrict:"E",replace:!1,scope:{data:"=",onClick:"&"},link:a}});